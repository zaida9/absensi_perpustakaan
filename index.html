<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Absensi Perpustakaan ğŸ“š</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Poppins&display=swap" rel="stylesheet">

<style>
body{
  font-family:Poppins;
  background:linear-gradient(135deg,#a8edea,#fed6e3);
  padding:20px;
}
.container{max-width:900px;margin:auto}
.header{
  background:white;padding:30px;border-radius:25px;
  text-align:center;margin-bottom:20px
}
.header h1{font-family:Fredoka;color:#6b46c1}
.card{background:white;padding:25px;border-radius:25px}
select{
  width:100%;padding:12px;margin-top:12px;
  border-radius:15px;border:2px solid #ddd
}
.moods{
  display:grid;grid-template-columns:repeat(3,1fr);
  gap:12px;margin-top:15px
}
.mood{
  font-size:32px;padding:20px;border-radius:20px;
  background:#ffeaa7;text-align:center;cursor:pointer
}
.mood.active{background:#a8edea;box-shadow:0 0 10px rgba(0,0,0,.2)}
button{
  margin-top:20px;width:100%;padding:15px;
  border:none;border-radius:20px;
  background:#ff6b9d;color:white;
  font-family:Fredoka;font-size:18px;cursor:pointer
}
table{
  width:100%;margin-top:20px;
  border-collapse:collapse;border-radius:20px;overflow:hidden
}
thead{background:#ff6b9d;color:white}
th,td{padding:10px;text-align:center}
tbody tr:nth-child(even){background:#f7f7ff}
</style>
</head>

<body>
<div class="container">

<div class="header">
<h1>ğŸ“š Absensi Perpustakaan</h1>
<p>Pilih nama & emoji sesuai perasaanmu âœ¨</p>
</div>

<div class="card">
<select id="jenjang" onchange="updateKelas()">
<option value="">Pilih Jenjang</option>
<option>Pra-TK</option>
<option>TK</option>
<option>SD</option>
<option>SMP</option>
</select>

<select id="kelas" onchange="updateNama()">
<option value="">Pilih Kelas</option>
</select>

<select id="nama">
<option value="">Pilih Nama</option>
</select>

<div class="moods">
<div class="mood" data="ğŸ˜„ Senang">ğŸ˜„</div>
<div class="mood" data="ğŸ˜¢ Sedih">ğŸ˜¢</div>
<div class="mood" data="ğŸ˜¡ Marah">ğŸ˜¡</div>
<div class="mood" data="ğŸ˜´ Lelah">ğŸ˜´</div>
<div class="mood" data="ğŸ¤¯ Stres">ğŸ¤¯</div>
<div class="mood" data="ğŸ˜ Biasa">ğŸ˜</div>
</div>

<button onclick="absen()">Absen ğŸ’–</button>

<input type="date" id="tanggal" style="margin-top:20px" onchange="tampilData()">

<table>
<thead>
<tr>
<th>No</th>
<th>Nama</th>
<th>Jenjang</th>
<th>Kelas</th>
<th>Mood</th>
<th>Waktu</th>
</tr>
</thead>
<tbody id="list"></tbody>
</table>
</div>

</div>

<script>
const siswa=[
 {nis:"24001",nama:"Aisyah",jenjang:"SD",angkatan:2022},
 {nis:"24002",nama:"Budi",jenjang:"SD",angkatan:2023},
 {nis:"24003",nama:"Citra",jenjang:"SMP",angkatan:2023},
 {nis:"24004",nama:"Dimas",jenjang:"TK",angkatan:2024},
 {nis:"24005",nama:"Elisa",jenjang:"Pra-TK",angkatan:2025}
];

const today=new Date().toISOString().split("T")[0];
document.getElementById("tanggal").value=today;
let mood="";

document.querySelectorAll(".mood").forEach(m=>{
 m.onclick=()=>{
   document.querySelectorAll(".mood").forEach(x=>x.classList.remove("active"));
   m.classList.add("active");
   mood=m.getAttribute("data");
 }
});

function hitungKelas(s){
 const tahun=new Date().getFullYear();
 if(s.jenjang==="Pra-TK") return "Pra-TK";
 if(s.jenjang==="TK"){
   return (tahun-s.angkatan)<=0?"TK A":"TK B";
 }
 if(s.jenjang==="SD") return tahun-s.angkatan+1;
 if(s.jenjang==="SMP") return tahun-s.angkatan+7;
}

function updateKelas(){
 const j=jenjang.value;
 kelas.innerHTML='<option value="">Pilih Kelas</option>';
 [...new Set(siswa.filter(s=>s.jenjang===j).map(s=>hitungKelas(s)))]
 .forEach(k=>kelas.innerHTML+=`<option>${k}</option>`);
}

function updateNama(){
 nama.innerHTML='<option value="">Pilih Nama</option>';
 siswa.filter(s=>s.jenjang===jenjang.value && hitungKelas(s)==kelas.value)
 .forEach(s=>nama.innerHTML+=`<option>${s.nama}</option>`);
}

function absen(){
 if(!nama.value||!mood){alert("Lengkapi ya ğŸ˜¡");return;}
 const data=JSON.parse(localStorage.getItem("absensi"))||{};
 if(!data[tanggal.value]) data[tanggal.value]=[];
 data[tanggal.value].push({
   nama:nama.value,jenjang:jenjang.value,
   kelas:kelas.value,mood,waktu:new Date().toLocaleTimeString()
 });
 localStorage.setItem("absensi",JSON.stringify(data));
 tampilData();
}

function tampilData(){
 const data=JSON.parse(localStorage.getItem("absensi"))||{};
 const d=data[tanggal.value]||[];
 list.innerHTML=d.length?d.map((x,i)=>`
<tr>
<td>${i+1}</td><td>${x.nama}</td><td>${x.jenjang}</td>
<td>${x.kelas}</td><td>${x.mood}</td><td>${x.waktu}</td>
</tr>`).join(""):`<tr><td colspan="6">Belum ada data</td></tr>`;
}
tampilData();
</script>

</body>
</html>
